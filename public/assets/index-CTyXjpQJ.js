import{d as k,r as p,f as y,c as b,a as g,b as o,w as r,u as v,o as w,e as m,_ as h}from"./index-BPpCGL3o.js";import{E as f,a as E,b as R,c as I,d as T}from"./axios-Cf9h-rNq.js";import{E as A}from"./button-Du39phmC.js";const L={class:"page-container"},N={class:"operate-container"},B=k({__name:"index",setup(U){const V=v(),u=p({chatLoading:!1}),n=p({target:"",targetValue:"",message:"填充A1-C8值为Lucky，每隔一个空出来"}),d={init(){const l={container:"sheet-container"};luckysheet.create(l)},cellRefToCoordinates(l,e){const i=l[0].toUpperCase(),s=l[1];let a=0;for(let t=0;t<i.length;t++){const C=i.charCodeAt(t)-65;a=a*26+(C+1)}a-=1;const c=Number.parseInt(s,10)-1;luckysheet.setCellValue(c,a,e)},checkRange(){return/^[A-Z]{1,3}\d{1,7}$/i.test(n.target)},setTargetValue(){const{target:l,targetValue:e}=n;d.checkRange()||f.error("目标单元格输入不正确，请检查"),d.cellRefToCoordinates(l,e)}},_={async chat(){u.chatLoading=!0;const l=await R.post("/api/chat",{message:n.message});u.chatLoading=!1;const{code:e,message:i}=l.data;e!==0&&f.error(e);const s=JSON.parse(i.content);for(const a of s)d.cellRefToCoordinates(a[0],a[1])}};function x(){V.push("/univer-test")}return y(()=>{d.init()}),(l,e)=>{const i=I,s=T,a=A,c=E;return w(),b("div",L,[g("div",N,[o(c,{inline:!0,model:n,class:"demo-form-inline"},{default:r(()=>[o(s,{label:"单元格"},{default:r(()=>[o(i,{modelValue:n.target,"onUpdate:modelValue":e[0]||(e[0]=t=>n.target=t),class:"common-input",width:"220",placeholder:"目标单元格",clearable:""},null,8,["modelValue"])]),_:1}),o(s,{label:"单元格值"},{default:r(()=>[o(i,{modelValue:n.targetValue,"onUpdate:modelValue":e[1]||(e[1]=t=>n.targetValue=t),class:"common-input",placeholder:"请输入单元格值",clearable:""},null,8,["modelValue"])]),_:1}),o(s,null,{default:r(()=>[o(a,{type:"primary",onClick:e[2]||(e[2]=t=>d.setTargetValue())},{default:r(()=>e[6]||(e[6]=[m(" 确认 ")])),_:1}),o(a,{type:"warning",onClick:e[3]||(e[3]=t=>x())},{default:r(()=>e[7]||(e[7]=[m(" 切换 univer ")])),_:1})]),_:1}),o(s,{style:{"margin-left":"50px"},label:"DeepSeek"},{default:r(()=>[o(i,{modelValue:n.message,"onUpdate:modelValue":e[4]||(e[4]=t=>n.message=t),type:"textarea",style:{width:"320px"},rows:2,placeholder:"",clearable:""},null,8,["modelValue"])]),_:1}),o(s,null,{default:r(()=>[o(a,{loading:u.chatLoading,type:"warning",onClick:e[5]||(e[5]=t=>_.chat())},{default:r(()=>e[8]||(e[8]=[m(" 执行 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),e[9]||(e[9]=g("div",{id:"sheet-container"},null,-1))])}}}),M=h(B,[["__scopeId","data-v-aefe7488"]]);export{M as default};
