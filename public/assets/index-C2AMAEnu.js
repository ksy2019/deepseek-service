import{d as v,r as f,h as k,w as y,c as C,a as _,b as t,e as r,f as w,o as b,g as p,_ as E}from"./index--InAb4pw.js";import{v as R}from"./loading-BrqfzaS6.js";import{E as g,a as I,b as L,c as P,d as T}from"./axios-DQ89y94W.js";import{E as A}from"./button-c3kZ9mpo.js";const N={class:"page-container"},B={class:"operate-container"},U=v({__name:"index",setup($){const V=w(),d=f({chatLoading:!1,changePage:!1}),n=f({target:"",targetValue:"",message:"填充A1-C8值为Lucky，每隔一个空出来"}),c={init(){const a={container:"sheet-container"};luckysheet.create(a)},cellRefToCoordinates(a,e){const i=a[0].toUpperCase(),s=a[1];let o=0;for(let u=0;u<i.length;u++){const l=i.charCodeAt(u)-65;o=o*26+(l+1)}o-=1;const m=Number.parseInt(s,10)-1;luckysheet.setCellValue(m,o,e)},checkRange(){return/^[A-Z]{1,3}\d{1,7}$/i.test(n.target)},setTargetValue(){const{target:a,targetValue:e}=n;if(!c.checkRange()){g.error("目标单元格输入不正确，请检查");return}c.cellRefToCoordinates(a,e)}},x={async chat(){try{d.chatLoading=!0;const a=await L.post("/api/chat",{message:n.message});d.chatLoading=!1;const{code:e,message:i}=a.data;e!==0&&g.error(e);const s=JSON.parse(i.content);for(const o of s)c.cellRefToCoordinates(o[0],o[1])}catch{g.error("DeepSeek执行时出错")}}};function h(){d.changePage=!0,V.push("/univer-test")}return k(()=>{c.init()}),(a,e)=>{const i=P,s=T,o=A,m=I,u=R;return y((b(),C("div",N,[_("div",B,[t(m,{inline:!0,model:n,class:"demo-form-inline"},{default:r(()=>[t(s,{label:"单元格"},{default:r(()=>[t(i,{modelValue:n.target,"onUpdate:modelValue":e[0]||(e[0]=l=>n.target=l),class:"common-input",width:"220",placeholder:"目标单元格",clearable:""},null,8,["modelValue"])]),_:1}),t(s,{label:"单元格值"},{default:r(()=>[t(i,{modelValue:n.targetValue,"onUpdate:modelValue":e[1]||(e[1]=l=>n.targetValue=l),class:"common-input",placeholder:"请输入单元格值",clearable:""},null,8,["modelValue"])]),_:1}),t(s,null,{default:r(()=>[t(o,{type:"primary",onClick:e[2]||(e[2]=l=>c.setTargetValue())},{default:r(()=>e[6]||(e[6]=[p(" 确认 ")])),_:1}),t(o,{type:"warning",onClick:e[3]||(e[3]=l=>h())},{default:r(()=>e[7]||(e[7]=[p(" 切换 univer ")])),_:1})]),_:1}),t(s,{style:{"margin-left":"50px"},label:"DeepSeek"},{default:r(()=>[t(i,{modelValue:n.message,"onUpdate:modelValue":e[4]||(e[4]=l=>n.message=l),type:"textarea",style:{width:"320px"},rows:2,placeholder:"",clearable:""},null,8,["modelValue"])]),_:1}),t(s,null,{default:r(()=>[t(o,{loading:d.chatLoading,type:"warning",onClick:e[5]||(e[5]=l=>x.chat())},{default:r(()=>e[8]||(e[8]=[p(" 执行 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),e[9]||(e[9]=_("div",{id:"sheet-container"},null,-1))])),[[u,d.changePage]])}}}),J=E(U,[["__scopeId","data-v-2a98d545"]]);export{J as default};
